---
title: "Reproducible Report Template - Basic"
author: "Student/s SID"
subtitle: "Project X"
date: "University of Sydney | Unit of Study | MONTH YEAR"
# You can change the title, subtitle, author etc.
# if you do not want a subtitle, author, or date just delete or comment # the the line!
output:
  html_document:
    fig_caption: yes
    number_sections: yes
    self_contained: yes
    theme: flatly
    # Other themes can be found at: https://bootswatch.com/
    css: 
      - https://use.fontawesome.com/releases/v5.0.6/css/all.css
    #This will allow you to insert icons in your document, thanks to [Font Awesome](http://fontawesome.io).
    #You will find an examples below.
    # If you are knitting your document but not connected to the internet, place a "#" in front of the css line above with the font-awesome.min.css line to comment it out. This will let you knit the document in draft form until you connect again and knit the final. Note that when you do this some elements will be missing from the knitted slides. 
    toc: true
    #This adds a Table of Contents (toc).
    toc_depth: 3
    #This controls the number of subheadings included in the toc.
    toc_float: true
    #This allows toc to update relative to your location as you scroll down the html page.
    code_folding: hide
    #code_folding can be changed to "hide"" if you want the all your code to be collapsed when you open the document
    
    # More information: http://rmarkdown.rstudio.com/html_document_format.html
---

<br>

# Client Bio & Recommendation [150 words]

- Identifies a real Client ('Client Bio') and gives a clear, concrete, relevant recommendation for that Client.

- Note: In your Client Bio (ie description of who your Client is), it is normal practise to give a LinkedIn url, or a company website page that profiles your client.

<br>


# Evidence [400 words]

```{r}
library(tidyverse)

# Load your data from a CSV file
data <- read_csv("natural-disasters.csv")

filterData <- data %>%
  filter(Entity %in% c("India", "United Kingdom", "United States", "Canada")) %>%
  select(Entity, Year, `Number of people affected by floods`, `Number of people left homeless from floods`)

# Filter data for India
india_data <- data %>% filter(Entity == "India")

# Select relevant columns and reshape the data
india_long <- india_data %>%
  select(Year, `Insured damages against drought`, `Insured damages against floods`,
         `Insured damages against earthquakes`) %>%
  pivot_longer(cols = starts_with("Insured damages"),
               names_to = "DisasterType",
               values_to = "InsuredDamages") %>%
  mutate(DisasterType = str_replace(DisasterType, "Insured damages against ", ""))

# Filter data for India starting from the year 1980 and remove NA values
india_long_filtered <- india_long %>%
  filter(Year >= 1980 & !is.na(InsuredDamages))

# Line plot to show trends over time
ggplot(india_long_filtered, aes(x = Year, y = InsuredDamages, color = DisasterType, group = DisasterType)) +
  geom_line() +
  geom_point() +
  labs(title = "Trends in Insured Damages in India for Various Disasters",
       x = "Year",
       y = "Insured Damages (in monetary units)",
       color = "Disaster Type") +
  theme_minimal() +
  scale_y_continuous(labels = scales::comma)



avgData <- filterData %>%
  group_by(Entity) %>%
  summarize(
    avgAffected = mean(`Number of people affected by floods`, na.rm = TRUE),
    avgHomeless = mean(`Number of people left homeless from floods`, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = c(avgAffected, avgHomeless), names_to = "Legends", values_to = "Value")

ggplot(avgData, aes(x = Entity, y = Value, fill = Legends)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  scale_y_log10(labels = scales::comma_format()) +
  labs(x = "Country", 
       y = "Log(Average Number of People)", 
       title = "Comparison of Flood Impact: Affected vs Homeless") +
  theme_minimal()
```


```{r}
# Filter data for the selected countries
countries <- c("India", "Canada", "United Kingdom", "United States")
filtered_data <- data %>% filter(Entity %in% countries)

# Perform ANOVA for number of people affected by floods
anova_affected <- aov(`Number of people affected by floods` ~ Entity, data = filtered_data)
summary(anova_affected)

# Perform ANOVA for number of people left homeless from floods
anova_homeless <- aov(`Number of people left homeless from floods` ~ Entity, data = filtered_data)
summary(anova_homeless)

# Interpret the p-values
p_value_affected <- summary(anova_affected)[[1]][["Pr(>F)"]][1]
p_value_homeless <- summary(anova_homeless)[[1]][["Pr(>F)"]][1]

cat("P-value for people affected by floods:", p_value_affected, "\n")
cat("P-value for people left homeless from floods:", p_value_homeless, "\n")

```


## Initial Data Analysis (IDA)

Summary:

- The data came from ...
- The data is/is not valid because ...
- Possible issues include ...
- Each row represents ...
- Each column represents ...

<br>

## Your Next Title Here

Insert text and analysis. 



# Acknowledgments

Style: APA 

<br>


# Appendix [200 words]

## Client Choice
How did you decide who your Client was, and how did that affect the content in your report?

## Statisitcal Analyses

Why did you choose what you did?

If you did linear modelling or hypothesis testing, show your process of HATPC here, with care to assumptions and interpretation.

If you did not use linear modelling or hypothesis testing, provide a convincing rationale as to why your chosen methods were the most appropriate. 

## Limitations